%YAML 1.1
---
# Snapcraft Recipe for The XSLT C library for GNOME
# ------------------------------
# This file is in the YAML data serialization format:
# http://yaml.org
# For the spec. of writing this file refer the following documentation:
# * The snapcraft format
#   https://docs.snapcraft.io/the-snapcraft-format/8337
# * Snap Documentation
#   https://docs.snapcraft.io
# * Topics under the doc category in the Snapcraft Forum
#   https://forum.snapcraft.io/c/doc
# For support refer to the snapcraft section in the Snapcraft Forum:
# https://forum.snapcraft.io/c/snapcraft
name: libxslt
summary: XSLT C library developed for the GNOME project
description: |
  Libxslt is the XSLT C library developed for the GNOME project. XSLT itself is a an XML language to define transformation for XML. Libxslt is based on libxml2 the XML C library developed for the GNOME project. It also implements most of the EXSLT set of processor-portable extensions functions and some of Saxon's evaluate and expressions extensions.

  People can either embed the library in their application or use xsltproc the command line processing tool. This library is free software and can be reused in commercial applications.

  This is NOT an official distribution of libxslt, for any issue regarding using this snap please refer to the issue tracker:

      https://github.com/Lin-Buo-Ren/libxslt-snap/issues

icon: snap/gui/libxslt.adapted.png

version: determined-by-version-script
version-script: ./snap/local/build-utilities/set-snap-version.bash

confinement: strict
grade: stable

plugs:
  # Storage access
  home:
  removable-media: # Non-A/C

  # Network access for fetching DTDs or entities over network
  network:

apps:
  xsltproc:
    command: >
      bin/locales-launch
      "${SNAP}"/bin/libxslt-launch
      "${SNAP}"/bin/xsltproc

parts:
  # Utility programs to help with package building
  build-utilities:
    source: snap/local/build-utilities
    plugin: dump
    organize:
      '*': assets/build-utilities/
    prime:
    - -*

  # Launcher programs to fix problems at runtime
  launchers:
    source: snap/local/launchers
    plugin: dump
    organize:
      '*': bin/
    stage:
    - -bin/README.*

  # Program patches to solve issues that can't be solved by tweaking in runtime
  #patches:
    #source: snap/local/patches
    #plugin: dump
    #organize:
      #'*': assets/patches/
    #prime:
    #- -*

  # Helper programs that can be called at snap runtime
  #helpers:
    #source: snap/local/helpers
    #plugin: dump
    #organize:
      #'*': bin/
    #stage:
    #- -bin/README.*

  # Remote part for fixing the glibc locales(and gnu gettext I18N support)
  # This part is only required for non GUI apps that don't uses the desktop-launch launchers
  locales-launch:

  # Remote part for recording the exact revision for each part during building
  parts-meta-info:

  # Remote part for libxml2
  libxml2:
    source-tag: v2.9.9
    prime:
    # Drop libxml2 files except for runtime libraries
    - $library-shared

  libxslt:
    after:
    - libxml2

    source: https://gitlab.gnome.org/GNOME/libxslt.git
    source-depth: 30

    # For building stable and release candidate releases
    #source-tag: v1.1.33-rc2

    plugin: autotools
    build-packages:
    - libgcrypt20-dev

    # Replaced by libxml2 part
    #- libxml2-dev

    - pkg-config

    # Not supported for now
    #stage-snaps:
    #- libxml2
